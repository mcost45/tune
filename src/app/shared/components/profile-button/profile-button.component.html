<ng-container *ngIf="{ user: user$ | async } as context">
	<ng-container *ngIf="context.user; then loggedInButton; else loggedOutButton"></ng-container>

	<ion-popover [trigger]="triggerId" reference="trigger">
		<ng-template>
			<app-profile-menu [user]="context.user"></app-profile-menu>
		</ng-template>
	</ion-popover>
</ng-container>

<ng-template #loggedInButton>
	<ion-button
		*ngIf="{ imageUrl: imageUrl$ | async } as context"
		[id]="triggerId"
		class="profile-button"
		size="large"
		shape="round"
		fill="outline"
		[ngStyle]="context.imageUrl | backgroundUrlCss"
	></ion-button>
</ng-template>

<ng-template #loggedOutButton>
	<ion-button size="large" shape="round" fill="outline" (click)="onLogin()">
		{{ 'ACTIONS.LOGIN' | translate }}
	</ion-button>
</ng-template>

<ng-template #menu></ng-template>
